
<!-- saved from url=(0046)file:///home/hddl/ltqusst.github.io/index.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252"></head><body>
    <h1>Memos</h1>
<h2>Install Ubuntu-based NV machine</h2>
    <pre>GPU Driver Install ======================================================================================
	Go into recovery mode by pressing SHIFT during boot
		drop into shell as root and remount filesystem
		mount -o remount,rw /
	
	backlist other kernel display drivers:
		/etc/modprobe.d/blacklist.conf
					blacklist nouveau
					#blacklist vga16fb
					#blacklist rivafb
					#blacklist nvidiafb
					#blacklist rivatv
		/etc/default/grub
				 GRUB_CMDLINE_LINUX="nomodeset"
		sudo update-grub

	Install
		 sudo sh NVIDIA-Linux-x86-185.18.14-pkg1.run 
	reboot

CUDA======================================================================================

	Kernel HEADERS
		The kernel headers and development packages for the currently running kernel can be installed with:
		$ sudo apt-get install linux-headers-$(uname -r)

	CUDA Toolkit
		https://developer.nvidia.com/cuda-downloads?target_os=Linux&amp;target_arch=x86_64&amp;target_distro=Ubuntu&amp;target_version=1604&amp;target_type=deblocal

		Installation Instructions:

			`sudo dpkg -i cuda-repo-ubuntu1604-9-2-local_9.2.88-1_amd64.deb`
			`sudo apt-key add /var/cuda-repo-<version>/7fa2af80.pub`
			`sudo apt-get update`
			`sudo apt-get install cuda`

		Other installation options are available in the form of meta-packages. For example, to install all the library packages, replace "cuda" with the "cuda-libraries-9-2" meta package. For more information on all the available meta packages click here.

		Patch 1 (Released May 16, 2018) 
		cuBLAS 9.2 Patch Update: This update includes fix to cublas GEMM APIs on V100 Tensor Core GPUs when used with default algorithm CUBLAS_GEMM_DEFAULT_TENSOR_OP. We strongly recommend installing this update as part of CUDA Toolkit 9.2 installation.

	 Meta packages
	 Meta packages are RPM/Deb packages which contain no (or few) files but have multiple dependencies. They are used to install many CUDA packages when you may not know the details of the packages you want. Below is the list of meta packages.
	Table 4. Meta Packages Available for CUDA 9.2 Meta Package 	Purpose
	cuda 	Installs all CUDA Toolkit and Driver packages. Handles upgrading to the next version of the cuda package when it's released.
	cuda-9-2 	Installs all CUDA Toolkit and Driver packages. Remains at version 9.2 until an additional version of CUDA is installed.
	cuda-toolkit-9-2 	Installs all CUDA Toolkit packages required to develop CUDA applications. Does not include the driver.
	cuda-tools-9-2 	Installs all CUDA command line and visual tools.
	cuda-runtime-9-2 	Installs all CUDA Toolkit packages required to run CUDA applications, as well as the Driver packages.
	cuda-compiler-9-2 	Installs all CUDA compiler packages.
	cuda-libraries-9-2 	Installs all runtime CUDA Library packages.
	cuda-libraries-dev-9-2 	Installs all development CUDA Library packages.
	cuda-drivers 	Installs all Driver packages. Handles upgrading to the next version of the Driver packages when they're released.


cuDNN(Optional)============================================================================
	tar xvzf cudnn-8.0-linux-x64-v5.1.tgz 
	cd cudnn 
	sudo cp include/cudnn.h /usr/local/cuda/include 
	sudo cp lib64/libcudnn* /usr/local/cuda/lib64 
	sudo chmod a+r /usr/local/cuda/include/cudnn.h /usr/local/cuda/lib64/libcudnn*


docker =================================================================================
	https://docs.docker.com/install/linux/docker-ce/ubuntu/#upgrade-docker-ce

  config docker behind proxy on Ubuntu:
  	https://docs.docker.com/config/daemon/systemd/
  add mirror for faster pull
        https://blog.csdn.net/shenzhen_zsw/article/details/74277518
		add `registry-mirrors": ["http://4e70ba5d.m.daocloud.io"]` to /etc/docker/daemon.json
		sudo service docker restart 

nvidia-docker2==========================================================================
	https://github.com/NVIDIA/nvidia-docker/wiki/Installation-(version-2.0)#prerequisites

pull image==========================================================================
	https://hub.docker.com/r/nvidia/cuda/tags/
    https://gitlab.com/nvidia/cuda/tree/ubuntu16.04
    
    We can see the magic of setting up environment by docker image
       https://gitlab.com/nvidia/cuda/blob/ubuntu16.04/9.0/base/Dockerfile

verify the installation==============================================================
    docker run --runtime=nvidia --rm nvdia/cuda nvidia-smi
    
    sudo docker run --runtime=nvidia --name caffe -it -v ~/dockerv0/:/dockerv0 --net=host nvidia/cuda /bin/bash

install cudnn inside container=============================================
    https://gitlab.com/nvidia/cuda/blob/ubuntu16.04/8.0/devel/cudnn6/Dockerfile

install Caffe==============================================================
    Best practice is following dockerfile instead of installation guide
    https://github.com/BVLC/caffe/blob/master/docker/gpu/Dockerfile
    

    </version></pre>
    <hr>
</body></html>